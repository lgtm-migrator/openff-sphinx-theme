// Thanks to Jeremy Maitin-Shepard. File sourced from
// https://github.com/jbms/sphinx-material/blob/b3667d67eee0a42a627c97a5a81a736c99dadb61/src/assets/stylesheets/main/_sphinx.scss

// Additional styles expected by sphinx.

// alignment of text and inline objects inside block objects
.align-left {
  text-align: left;
}

.align-right {
  text-align: right;
}

.align-center {
  clear: both;
  text-align: center;
}

.align-top {
  vertical-align: top;
}

.align-middle {
  vertical-align: middle;
}

.align-bottom {
  vertical-align: bottom;
}

// Figures, Images, and Tables
.figure.align-left,
figure.align-left,
img.align-left,
object.align-left,
table.align-left {
  margin-right: auto;
}

.figure.align-center,
figure.align-center,
img.align-center,
object.align-center,
table.align-center {
  margin-right: auto;
  margin-left: auto;
}

.figure.align-right,
figure.align-right,
img.align-right,
object.align-right,
table.align-right {
  margin-left: auto;
}

.figure.align-center,
.figure.align-right,
figure.align-center,
figure.align-right,
img.align-center,
img.align-right,
object.align-center,
object.align-right {
  display: block;
}

// reset inner alignment in figures and tables
.figure.align-left,
.figure.align-right,
figure.align-left,
figure.align-right,
table.align-left,
table.align-center,
table.align-right {
  text-align: inherit;
}

.rubric {
  font-weight: bold;
}

// And now my own rules
/// Code with line numbers in sphinx<4
table.highlighttable {
  td.linenos {
    @include unselectable;
    padding-left: 0;
    padding-right: 0;
    .linenodiv pre {
      padding-right: 0;
      // Hide line numbers on mobile
      @media screen and (max-width: $tablet - 1px) {
        display: none;
      }
    }
    + td.code {
      margin-left: 0;
      padding-left: 0;
      padding-right: 0;
      .highlight pre {
        overflow-x: auto;
        // Hide line numbers on mobile
        @media screen and (max-width: $tablet - 1px) {
          width: 100vw - 2 * $mobile-content-margin-y;
        }
      }
    }
  }
}

.highlight {
  background-color: $code-background;
  border-radius: 4px;
  // Unselectable prompts and line numbers
  .gp, .linenos {
    @include unselectable;
  }
  // Scrollbar and margins on the .highlight, not the inner pre
  overflow-x: auto;
  margin: 1em 0;
  pre {
    overflow-x: unset;
    margin: unset;
  }
  // Neat but expandable code blocks;
  @media screen and (min-width: $desktop) {
    width: fit-content;
    max-width: 100%;
    min-width: 80ex;
  }
  /// Code with line numbers in sphinx>=4
  span.linenos {
    margin-right: 1.5rem;
    // Hide line numbers on mobile
    @media screen and (max-width: $tablet - 1px) {
      display: none;
    }
  }
}

// Header links
.headerlink {
  font-size: 1em;
  margin-left: 0.5em;
  color: $grey-light;

  @media screen and (min-width: $tablet) {
    display: inline-block;
    transform: translateY(.25rem);
    transition: transform .25s 0.2s,color .25s,opacity .125s 0.2s;
    opacity: 0;
  }
}
*:hover > .headerlink {
  transition: transform .25s,color .25s,opacity .125s;
  -webkit-transform: translate(0);
  transform: translate(0);
  opacity: 1;
}

// Format captions
.toctree-wrapper .caption {
  @extend h2;
}

// Don't let Sphinx try to be clever about what header level the index heading is
#index h3 {
  @extend h2;
}

// Prose paragraphs should wrap at around 80 characters
// The visual artifact is almost unnoticeable and the
// improved ease of reading is enormous,
// and theres no issues with having to condense API stuff
p:not(.admonition-title) {
  max-width: 80ex;
}

// Use Bulma's tables
table {
  @extend .table;
}

// Citations
dl.citation {
  // Label for the reference/citation. Block element
  > dt.label {

  }
  > dd {
    margin-top: 0;
      :first-child {
        margin-top: 0;
      }
  }
}


// Unset Bulma .file class in .content
.file {
  align-items: unset;
  display: unset;
  justify-content: unset;
  position: unset;
}

// Add brackets to references that ask for it
a.brackets {
  &::before {
    content: "[";
  }
  &::after {
    content: "]";
  }
}


// Add language identifiers to code blocks
@mixin language-identifier($langname) {
  .highlight pre::before {
    content: $langname;
    color: #696969;
    font-size: 80%;
    font-family: $family-monospace;
    padding: 0;
    margin: -1rem;
    float: right;
    font-variant: small-caps;
  }
}

.highlight-python {
  @include language-identifier("Python");
}

.highlight-sh, .highlight-shell-session {
  @include language-identifier("Shell");
}

.highlight-yaml {
  @include language-identifier("YAML");
}

.highlight-json {
  @include language-identifier("JSON");
}

.highlight-html {
  @include language-identifier("HTML");
}

.highlight-javascript {
  @include language-identifier("JavaScript");
}

.highlight-jinja {
  @include language-identifier("Jinja");
}